let _categories=["top","world","national","business","tech","entertainment","sports","science","politics","health","food","travel"];const CATEGORIES_TOP=Object.freeze(_categories.slice(0)),CATEGORIES=Object.freeze(_categories.slice(1)),cookiesEnabled=navigator.cookieEnabled;let header=document.getElementById("header"),newsSection=document.getElementById("news-section"),body=document.getElementsByTagName("body")[0],backButton=document.getElementById("article-back-button"),menuButton=document.getElementById("menu-button"),footer=document.getElementById("footer"),ui=getFromCookie("ui"),position=[],isMobile=!1;function detectMobile(){window.navigator.userAgent;isMobile=window.innerWidth<1024}function timeSince(e){let t=Math.floor((new Date-e)/1e3),s=Math.floor(t/31536e3);return s>1?s+" years":1===s?s+" year":(s=Math.floor(t/2592e3))>1?s+" months":1===s?s+" month":(s=Math.floor(t/86400))>1?s+" days":1===s?s+" day":(s=Math.floor(t/3600))>1?s+" hours":1===s?s+" hour":(s=Math.floor(t/60))>1?s+" minutes":1===s?s+" minute":Math.floor(t)+" seconds"}function post(e){if(void 0!==e.ui){let t=new URL(location.origin);Object.keys(e).forEach(s=>t.searchParams.append(s,e[s])),fetch(t.href,{method:"GET",headers:new Headers({"Content-Type":"application/json"}),mode:"no-cors"}).then(e=>e).catch(e=>{console.warn("fail log")}).then(e=>{})}}function pushHistory(e){let t=window.location.pathname+"?s_category="+encodeURIComponent(e);history.pushState({},"category",t),gtag("event","page_view",{page_path:t,timestamp:(new Date).getTime(),category:e})}function getUrlState(){let e={};return location.search.substr(1).split("&").forEach(t=>{let s=t.split("=");e[s[0]]=decodeURIComponent(s[1])}),e}function getFromCookie(e){let t=document.cookie;if(t){let s=t.split(";");for(let t=0;t<s.length;t++)if(s[t].indexOf(e)>=0){return s[t].split("=")[1]}}return!1}let overlay=document.getElementById("overlay");function showOverlay(){overlay.classList.remove("hidden")}function hideOverlay(){overlay.classList.add("hidden")}overlay&&overlay.addEventListener("click",function(e){let t=new Event("close-menu");document.dispatchEvent(t)});class Preferences{constructor(e,t,s){this.cookieName="preferences",this.preferences=new Map;for(let e=0;e<CATEGORIES.length;e++)this.preferences.set(CATEGORIES[e],1);this.temp=new Map(this.preferences);let o=null;if(e){o=this.extractBitMap(e);for(let e=0;e<o.length;e++)CATEGORIES[e]===o[e]?this.preferences.set(CATEGORIES[e],1):this.preferences.set(CATEGORIES[e],0)}gtag("set","prefs",this.checkPrefChanged()?o:"null"),this.body=t,this.ev=new Event("newPreferences"),this.newsSection=s,this.setupView()}setupView(){this.pref=document.querySelector("#preference-menu"),document.querySelector(".pref-header").querySelector(".close-menu").addEventListener("click",()=>{this.save(),this.hide()}),document.addEventListener("close-menu",()=>{this.save(),this.hide()}),this.pref.addEventListener("change",e=>{let t=e.target.id.split("-")[0];e.target.checked?this.preferences.set(t,1):this.preferences.set(t,0)});for(let e=0;e<CATEGORIES.length;e++){let t=CATEGORIES[e],s=t+"-toggle-button-input",o=document.getElementById(s);1===this.preferences.get(t)?o.checked=!0:o.checked=!1}return this.pref}save(){const e=this.convertToBitMap().toString();gtag("set","prefs",this.checkPrefChanged()?e:"null");document.cookie=this.cookieName+"="+e+";max-age=2592000",document.dispatchEvent(this.ev)}convertToBitMap(){let e=[];for(let t=0;t<CATEGORIES.length;t++)e.push(this.preferences.get(CATEGORIES[t]));return e}extractBitMap(e){let t=e.split(","),s=[];for(let e=0;e<CATEGORIES.length;e++)"1"===t[e]?s[e]=CATEGORIES[e]:s[e]="noop";return s}getPreferences(){const e=this.convertToBitMap().toString();return this.extractBitMap(e)}checkPrefChanged(){for(let[e,t]of this.preferences){if(t!==this.temp.get(e))return!0}return!1}show(){this.pref.classList.add("open-right"),this.body.style.overflow="hidden",this.temp=new Map(this.preferences),showOverlay()}hide(){this.pref.classList.remove("open-right"),this.body.style.overflow="initial",hideOverlay()}}class uiMenu{constructor(e,t,s,o){this.menu=e,this.open=t,this.close=s,this.newsSection=o,this.body=document.getElementsByTagName("body")[0],this.open.addEventListener("click",this.openMenu.bind(this)),this.close.addEventListener("click",this.closeMenu.bind(this)),document.addEventListener("close-menu",function(e){this.closeMenu()}.bind(this))}openMenu(){this.menu.classList.add("open"),this.position=window.pageYOffset,this.body.style.overflow="hidden",showOverlay()}closeMenu(){this.menu.classList.remove("open"),this.body.style.overflow="initial",hideOverlay()}}class Article{constructor(e){this.body=e,this.iframe=document.createElement("iframe"),this.iframe.id="frame",this.iframe.frameBorder=0}load(){let e,t=getUrlState();try{e=t.news,e+="=samsung_i18n&",e+="token="+encodeURIComponent(t.token)+"&",e+="impr_id="+encodeURIComponent(t.impr_id)+"&",e+="channel_id="+encodeURIComponent(t.channel_id)+"&",e+="lang="+encodeURIComponent(t.lang)+"&",e+="region="+encodeURIComponent(t.region)+"&",e+="recommend_time="+encodeURIComponent(t.recommend_time)+"&",e+="content_space="+encodeURIComponent(t.content_space)+"&",e+="no_personal="+encodeURIComponent(t.no_personal)}catch(e){}e&&this.show(e,"",!1)}show(e,t,s){if(s){let s=location.origin+"?news="+e+"&cat="+encodeURIComponent(t);history.pushState({},"",s)}this.iframe.src=e,document.getElementById("frame")||(this.body.appendChild(this.iframe),this.body.style.height="100%")}hide(){try{document.getElementById("frame").remove(),document.getElementsByTagName("body")[0].style.height="100%"}catch(e){}}}class Webpage{constructor(e,t,s,o,n,i,r,a,c){this.article=e,this.backButton=t,this.menuButton=s,this.footer=o,this.newsSection=n,this.existingPreferences=i,this.cookiesEnabled=r,this.preferences=a,this.isMobile=c}showFromUrl(e=!1){let t=getUrlState(),s=t.s_category;s?this.category(s):t.news?(this.article.load(),this.showNewsLayout()):(this.home(e),t.s_id?(gtag("set",{qaid:t.s_id}),history.replaceState({},"",window.location.origin)):gtag("set",{qaid:"null"})),s||t.news}showNewsSection(){var e=this.newsSection.style.opacity;if(e){!function t(){(e=parseFloat(e))<1&&(e+=parseFloat(.1),setTimeout(()=>{t()},35)),newsSection.style.opacity=e}()}this.newsSection.classList.remove("hide"),this.footer.classList.remove("hide")}hideNewsSection(){this.newsSection.classList.add("hide")}home(e=!0){e||console.log("dont reset");let t=document.getElementsByClassName("category-section");for(let e=0,s=t.length;e<s;e++)t[e].classList.remove("selected"),t[e].classList.remove("hide");if(e){const e=5;document.getElementsByClassName("card");this.category("All");let t=document.getElementsByClassName("category-section");for(let s=0,o=t.length;s<o;s++){let o=t[s].getElementsByClassName("card");for(let t=0,s=o.length;t<s;t++)t<e?o[t].classList.remove("hide"):o[t].classList.add("hide")}let s=document.getElementsByClassName("more-button");for(let e=0,t=s.length;e<t;e++)s[e].classList.remove("hide")}backButton.classList.add("hide"),menuButton.classList.remove("hide"),this.article.hide(),this.showNewsSection(),this.cookiesEnabled&&!this.existingPreferences&&this.isMobile&&this.preferences.show(),this.showPreferences(),document.title="News from Samsung"}category(e,t){t=void 0===t||t,getUrlState().news||this.article.hide();let s=document.getElementsByClassName("category-section");for(let o=0,n=s.length;o<n;o++)s[o].classList.remove("hide"),s[o].classList.remove("selected"),s[o].id!==e+"-section"&&"All"!==e&&t&&s[o].classList.add("hide"),s[o].id===e+"-section"&&s[o].classList.add("selected");let o=document.querySelector(".more-"+e+"-button");o&&o.classList.add("hide"),this.article.hide(),this.showNewsSection(),document.title=e.charAt(0).toUpperCase()+e.slice(1)+" · News from Samsung"}news(e,t,s){this.article.show(e,t,s),this.showNewsLayout()}showNewsLayout(){this.footer.classList.add("hide"),this.menuButton.classList.add("hide"),this.backButton.classList.remove("hide"),this.hideNewsSection()}showPreferences(){if(this.existingPreferences){let e=document.getElementsByClassName("category-section");for(let t=0;t<e.length;t++){let s=e[t].id.replace("-section","");this.existingPreferences.includes(s)||e[t].classList.add("hide")}document.getElementById("top-section").classList.remove("hide")}}prioritizePreferences(){let e=[],t=[],s=document.getElementsByClassName("category-section");for(let o=0;o<s.length;o++){let n=s[o].id.replace("-section","");"top"===n?e.push(s[o]):this.existingPreferences.includes(n)?e.push(s[o]):t.push(s[o])}for(;this.newsSection.firstChild;)this.newsSection.removeChild(this.newsSection.firstChild);for(let t=0;t<e.length;t++)this.newsSection.appendChild(e[t]);for(let e=0;e<t.length;e++)this.newsSection.appendChild(t[e])}updatePreferences(e){this.existingPreferences=e}}!function(){let e=document.querySelector(".news-cards-sections.hero > div:first-child a"),t=e.querySelector(".card-img-top").getAttribute("src");t=t.replace(/list\/((\d+)x+(\d+)\/)?/,"large/");let s,o,n=document.createElement("img");if(n.setAttribute("src",t),n.classList.add("hero-img"),e.insertAdjacentElement("afterbegin",n),detectMobile(),cookiesEnabled&&isMobile){getFromCookie("pushClicked")&&(document.cookie="pushClicked=true;max-age=2419200");let e=getFromCookie("preferences");o=new Preferences(e,body,newsSection),e&&(s=o.extractBitMap(e),document.cookie="preferences="+e+";max-age=2592000")}else gtag("set","prefs","unsupported");let i=new Article(body),r=new Webpage(i,backButton,menuButton,footer,newsSection,s,cookiesEnabled,o,isMobile);window.onpopstate=function(){r.showFromUrl(!1);try{let e=position.pop();window.scrollTo(0,e)}catch(e){}};window.pageYOffset;let a=document.getElementById("menu"),c=document.getElementById("menu-button"),l=document.getElementById("close-menu"),d=document.getElementById("settings");if(window.addEventListener("message",e=>{if("page_url_change"===e.data.type){let t="/?news="+e.data.value;getUrlState().s_qa?location.href=t+"&s_qa":location.href=t}}),window.addEventListener("message",e=>{"go_back"==e.data.type&&window.history.back()}),isMobile){let e=!1,t=0,s=10,n=50,i=0;window.addEventListener("scroll",t=>{e=!0}),window.addEventListener("message",t=>{"scrollY"==t.data.type&&(i=t.data.value,Number.isInteger(i)&&(e=!0))});let d=()=>{let e=0;e=i||(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop),Math.abs(t-e)<=s||(e>t&&e>n?header.classList.add("up"):header.classList.remove("up"),i=0,t=e)};setInterval(t=>{e&&(d(),e=!1)},250);new uiMenu(a,c,l,newsSection);cookiesEnabled&&document.addEventListener("newPreferences",e=>{let t=o.getPreferences();r.updatePreferences(t),r.showFromUrl(!0)},!1)}cookiesEnabled&&o?d.addEventListener("click",()=>{o.show()}):d.classList.add("hidden"),function(){let e=document.getElementById("close-menu");menu.addEventListener("click",t=>{if(!t.target||!t.target.matches("[data-category]"))return;let s=t.target.dataset.category;position.push(window.pageYOffset),pushHistory(s),r.category(s),isMobile&&e.click(),window.scrollTo(0,0);let o={category:s,ui:ui};post(o),backButton.classList.remove("hide"),menuButton.classList.add("hide")})}(),newsSection.addEventListener("click",function(e){if(e.target&&e.target.matches(".more-button")){let t=e.target.dataset.category,s=document.querySelectorAll("#"+t+"-news-cards .card.hide");const o=5;for(let e=0;e<s.length&&e<o;e++){s[e].classList.remove("hide")}s.length-o<=0&&e.target.classList.add("hide"),post({category:t,ui:ui})}},!1),newsSection.addEventListener("click",e=>{for(let t=0;t<e.path.length;t++){let s=e.path[t];if("A"===s.nodeName){e.preventDefault();let t=s.href,o=s.parentNode.dataset.category,n=s.querySelector(".card-title");document.title=n.innerHTML+" · News from Samsung",position.push(window.pageYOffset),r.news(t,o,!0),gtag("event","page_view",{page_path:t,timestamp:(new Date).getTime(),category:o}),post({url:t,ui:ui});break}}e.stopPropagation()},!1),r.showFromUrl(!0),backButton.addEventListener("click",e=>{window.history.back(),footer.classList.remove("hide")});let h=document.getElementsByClassName("card-date");for(let e=0,t=h.length;e<t;e++){let t=timeSince(1e3*h[e].dataset.time);{let e=t.split(" ");t=e[0]+e[1].substring(0,1)}h[e].innerHTML=t+" ago"}gtag("event","page_view",{page_path:"/"+window.location.search,timestamp:(new Date).getTime(),category:"top"}),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(function(e){for(let t of e)t.unregister()})}();